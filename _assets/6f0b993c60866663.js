(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[35024],{

/***/ 290881:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(813110);__web_req__(621815);self._7ccc7343da2ae983607b3819c7bc1f93 = self._7ccc7343da2ae983607b3819c7bc1f93 || {};(function(__c) {var DI=__c.DI;var Kc=__c.Kc;var Q=__c.Q;var II=__c.II;var Gg=__c.Gg;var cw=__c.cw;var D=__c.D;var F=__c.F;var O=__c.O;var mz=__c.mz;
var P4=function(){const [a]=(0,__c.dc)(()=>mz());return a},bPb=function(a){switch(a){case 4:return O("9ND0kg");case 2:return O("ibdecg");case 7:return O("446quA");case 5:return O("j1fbqg");case 1:return O("O5i4AQ");case 6:return O("C0VHsg");case 3:return O("+IXmVg");default:throw new F(a);}},cPb=function(a,b,c){const d=[a];for(;null!=a&&a!==b;)(a=c.next(a))&&d.push(a);return d},dPb=function(a){return b=>({type:"react",node:(0,__c.N)(a,{...b})})},fPb=function(a){var b,c=a.Vz;const d=a.content;a=a.context;
__c.B("formula"===(null===d||void 0===d?void 0:null===(b=d.vg)||void 0===b?void 0:b.type));b=d.vg.value;switch(b.type){case "invalid":b=b.xda;break;case "canonical":b=b.uL;break;default:throw new F(b);}__c.B(b.startsWith("="));const e=d.Hn;b={type:"dom",render:f=>f.innerText=""};switch(e.type){case 8:c=b;break;case 1:case 3:case 4:case 2:case 5:case 6:case 7:c=ePb(c,a,d.DA);break;case 0:c={type:"react",node:Q4(__c.hS,{label:bPb(e.error),children:Q4(__c.pA,{width:"full",display:"flex",justifyContent:"center",
children:Q4(__c.nsb,{tone:"critical"})})})};break;default:throw new F(e);}return null!==c&&void 0!==c?c:b},ePb=function(a,b,c){var d;return null===(d=a.Pha)||void 0===d?void 0:d.call(a,{context:b,value:c})},iPb=function(a){const b=a.Vz,c=a.tf;a=a.Gjb;b.Pha=__c.xGa;b.WAa=d=>fPb({...d,Vz:b});b.XAa=dPb(gPb({tf:c,$P:void 0}));b.ZAa=hPb(a);b.$Aa=dPb(R4)},jPb=function({label:a,width:b,height:c,scale:d,bEa:e}){return Q4("div",{style:{width:b,height:c,transform:`scale(${d})`},className:"bx74uQ",children:Q4(__c.mA,
{className:S4("ivlMMQ",T4(e)),size:"small",alignment:"center",children:a})})},T4=function(a){return{_2BX0vg:"primary-default"===a,JfW_Cg:"primary-low"===a,isMgNg:"primary-active"===a,xwWDeQ:"secondary-default"===a,w0EyUQ:"secondary-low"===a,_8p5AIA:"secondary-active"===a}},lPb=function({Cd:a,cJa:b,scale:c,fp:d,gp:e,hWa:f}){const g=U4(()=>{const m=null===d||void 0===d?void 0:d.get();if(null!=m&&0!==m.length)return new __c.lF(m)},[d]),h=e(1),k=e(c),l={ssE9Tg:!a,OkifGQ:a};return Q4(__c.nA,{pq:"light",
light:"light",ut:"light",dark:"light",children:m=>Q4("div",{className:S4("ze9QCQ",l,m.className),style:{width:k,height:k},children:Q4("div",{style:{width:h,height:h,transform:`scale(${c})`},className:S4("N7J3UA",l),ref:null===g||void 0===g?void 0:g.Yl,children:Q4(__c.nS,{className:S4("m8CFdg",l,{G6wL4w:f,W_E0wA:b}),ariaLabel:O("ruWN9A"),children:Q4(kPb,{size:"tiny"})})})})})},nPb=function(){const a=new mPb,b=new __c.IS,c=V4(f=>{const {scale:g=1,YIa:h,size:k="small",hWa:l=!0}=f,m=W4(n=>a.gp({scale:n,
size:k,gra:h}),[k,h]);return Q4(lPb,{...f,scale:h?Math.max(g,h):g,Cd:"rtl"===f.sheet.direction,cJa:null!=f.selection&&a.x$a(f.sheet,f.selection),gp:m,hWa:l})}),d=V4(f=>{const {scale:g=1,YIa:h,size:k="small",sheet:l,selection:m,jhb:n}=f,p=W4(v=>a.gp({scale:v,size:k,gra:h}),[k,h]),q=h?Math.max(g,h):g,r=W4(v=>null!=m&&a.dva(m).has(v),[m]),t=W4(v=>null!=m&&a.r8a(l,m).has(v),[l,m]),u=W4(v=>{const x=null!=n&&0<=l.layout.cols.Pe(v,n.Ub)&&0>=l.layout.cols.Pe(v,n.Mc);return r(v)?x?"secondary-active":"primary-active":
t(v)?x?"secondary-low":"primary-low":x?"secondary-default":"primary-default"},[l,n,t,r]);return Q4(X4,{...f,Ed:g,Td:q,gp:p,KE:u,yF:b})}),e=V4(f=>{const {scale:g=1,YIa:h,size:k="small",sheet:l,selection:m,jhb:n}=f,p=W4(v=>a.gp({scale:v,size:k,gra:h}),[k,h]),q=h?Math.max(g,h):g,r=W4(v=>null!=m&&a.fva(m).has(v),[m]),t=W4(v=>null!=m&&a.s8a(l,m).has(v),[l,m]),u=W4(v=>{const x=null!=n&&0<=l.layout.rows.Pe(v,n.bc)&&0>=l.layout.rows.Pe(v,n.Yc);return r(v)?x?"secondary-active":"primary-active":t(v)?x?"secondary-low":
"primary-low":x?"secondary-default":"primary-default"},[l,n,t,r]);return Q4(Y4,{...f,Ed:q,Td:g,gp:p,KE:u,yF:b})});return{IWa:c,HWa:d,JWa:e}},oPb=function(a){const b=a.Xp,c=()=>null;return __c.wz(d=>Q4(Z4,{...d,Xp:b,qh:c}))},pPb=function({sheet:a,aa:b,range:c,Nd:d}){$4(()=>a5(()=>{if(null!=d.current){var e,f=null!==(e=null===b||void 0===b?void 0:b.get())&&void 0!==e?e:1;e="rtl"===a.direction;e=c?a.Aa(c.Ub)*f*(e?1:-1):0;var g=c?-a.Ba(c.bc)*f:0;d.current.style.transform=`translate(${e}px, ${g}px)`;d.current.style.width=
`${a.width*f}px`;d.current.style.height=`${a.height*f}px`}}),[a,c,d,b])},sPb=function({onScroll:a}){const b=new qPb(a);return{AC:b,zha:V4(c=>Q4(rPb,{sheet:c.sheet,AC:b,children:c.children}))}},vPb=function(a){const b=a.Xp,c=a.Ue,d=a.eSa,e=({children:k})=>k,{AC:f,zha:g}=sPb({onScroll:a.onScroll});class h extends tPb{get bL(){const k=this.props.qa.Wx;switch(k){case "screen":return g;case "print":return e;default:throw new F(k);}}componentDidMount(){d.VRa(this.props.item,{Xb:this.props.Xb,qa:this.props.qa})}componentWillUnmount(){d.U0a(this.props.item,
{Xb:this.props.Xb,qa:this.props.qa})}render(){d.VRa(this.props.item,{Xb:this.props.Xb,qa:this.props.qa});return Q4(uPb,{...this.props,aa:this.aa,Xp:b,bL:this.bL,qh:this.qh,eSa:d,AC:f})}constructor(...k){super(...k);this.aa=b5(()=>{const l=this.props.item;var m=this.props.qa,n=m.Wx;m=m.zoom;switch(n){case "screen":return m;case "print":n=d.E7a(l);if(!n)return 1;({width:n}=new __c.BF(l,n.Xb,{zoom:m}));return n/l.config.width;default:throw new F(n);}});this.qh=V4(l=>Q4("div",{className:"wKvivQ",children:Q4(__c.EGa,
{...this.props,...l,Ue:c})}))}}return{CYa:h,AC:f}},wPb=function(a,b){if(null!=b&&null!=b.Ub&&null!=b.bc&&null!=b.Mc&&null!=b.Yc){var c=a.Aa(b.Ub),d=a.Ba(b.bc),e=a.Aa(b.Mc)+b.Mc.width-c;a=a.Ba(b.Yc)+b.Yc.height-d;return __c.Aw({top:d,left:c,width:e,height:a})}},yPb=function(a){const b=a.Xp,c=()=>null;return d=>Q4(xPb,{...d,Xp:b,qh:c})},CPb=function(a,b,c,d,e,f){if(0===d.length||0===e.length)return[];const g=zPb(b,c,d,e);f=APb(b,c,d,e,f);const h=BPb(a,b,c,d,e),k=a.A7a(b),l=a.T6a(b),m="rtl"===b.direction;
a=g.map(n=>{var p,q,r=n.Nib,t=n.Qma,u=n.MQa;const v=n.color,x=n.weight;n=n.mc;const y=m?-1:1,z=null===(p=h.get(c5(r,u)))||void 0===p?void 0:p.Ta;p=null===(q=h.get(c5(t,u)))||void 0===q?void 0:q.Aa;if(null!=z&&null!=p){q=D(k.get(u.va));var A=D(l.get(r.column));r=D(l.get(t.column));u="start"===u.boundary?q.start:q.end;q=A.start;t="start"===t.boundary?r.start:r.end;return{color:v,weight:x,mc:n,p1:new cw(q+z*y,u),p2:new cw(t+p*y,u),...__c.KI((t-q)*y,n*x,z)}}}).filter(__c.zb);return[...f.map(n=>{var p,
q,r=n.TDa,t=n.Xib,u=n.Tma;const v=n.color,x=n.weight;n=n.mc;const y=null===(p=h.get(c5(r,t)))||void 0===p?void 0:p.Ma;p=null===(q=h.get(c5(r,u)))||void 0===q?void 0:q.Ba;if(null!=y&&null!=p){q=D(l.get(r.column));var z=D(k.get(t.va));t=D(k.get(u.va));r="start"===r.boundary?q.start:q.end;q=z.start;u="start"===u.boundary?t.start:t.end;return{color:v,weight:x,mc:n,p1:new cw(r,q+y),p2:new cw(r,u+p),...__c.KI(u-q,n*x,y)}}}).filter(__c.zb),...a]},DPb=function(a){const b=[];a=a.filter(c=>0!==c.weight&&null!=
c.color);a=__c.md(a,c=>c.weight);a=Array.from(a.entries()).sort(([c],[d])=>c-d);for(const [c,d]of a){a=__c.md(d,e=>`${e.Xj}_${e.Yj}`);for(const [,e]of a){const {Yj:f,Xj:g}=e[0];a=__c.md(e,h=>h.color);for(const [h,k]of a)b.push({weight:c,color:h,lines:k,Xj:g,Yj:f})}}return b},FPb=function(a,b,c,d){var e=EPb;const f=b.get().flatMap(k=>a.layout.rows.last()===k?[{va:k,boundary:"start"},{va:k,boundary:"end"}]:[{va:k,boundary:"start"}]),g=c.get().flatMap(k=>a.layout.cols.last()===k?[{column:k,boundary:"start"},
{column:k,boundary:"end"}]:[{column:k,boundary:"start"}]),h=new Map;for(const k of b.get())for(const l of c.get())b=l&&k?e.dSa.Hgb(a,l,k):void 0,b&&h.set(`${l.id}:${k.id}`,b);c=CPb(e,a,h,f,g,d);return DPb(c)},zPb=function(a,b,c,d){const e=[];for(const k of c)for(const l of d){c=k.va;var f=l.column,g=a.layout.cells.get(c,f);if(!g||("start"===k.boundary?g.span.bc===c:g.span.Yc===c))if(c=b.get(`${f.id}:${c.id}`),c="start"===k.boundary?null===c||void 0===c?void 0:c.Ba:null===c||void 0===c?void 0:c.Ma){g=
e[e.length-1];f=(f=a.layout.cols.next(f))?{column:f,boundary:"start"}:{column:D(a.layout.cols.last()),boundary:"end"};var h;if(h=g)h=g.Qma,h=h.column===l.column&&h.boundary===l.boundary;h&&(h=g.MQa,h=h.va===k.va&&h.boundary===k.boundary);h&&g.color===c.color&&g.weight===c.weight&&g.mc===c.mc&&0===g.mc?g.Qma=f:e.push({MQa:k,Nib:l,Qma:f,color:c.color,weight:c.weight,mc:c.mc})}}return e},APb=function(a,b,c,d,e){const f=[];for(const l of d)for(const m of c){var g=m.va,h=l.column;d=a.layout.cells.get(g,
h);if(!d||("start"===l.boundary?d.span.Ub===h:d.span.Mc===h))if(d=b.get(`${h.id}:${g.id}`),(d="start"===l.boundary?null===d||void 0===d?void 0:d.Aa:null===d||void 0===d?void 0:d.Ta)&&("start"!==l.boundary||1!==e(g,h))){h=f[f.length-1];g=(g=a.layout.rows.next(g))?{va:g,boundary:"start"}:{va:D(a.layout.rows.last()),boundary:"end"};var k;if(k=h)k=h.TDa,k=k.column===l.column&&k.boundary===l.boundary;k&&(k=h.Tma,k=k.va===m.va&&k.boundary===m.boundary);k&&h.color===d.color&&h.weight===d.weight&&h.mc===
d.mc&&0===h.mc?h.Tma=g:f.push({TDa:l,Xib:m,Tma:g,color:d.color,weight:d.weight,mc:d.mc})}}return f},BPb=function(a,b,c,d,e){const f=a.dSa.V1a(c,b.layout.rows.last(),b.layout.cols.last());a=(q,r)=>{const t=f.get(q)||0,u=f.get(r)||0;return t<=u?q:r};const g=new Map;if(0===d.length||0===e.length)return g;var h=[],k=b.layout.cols.Lc(e[0].column);k&&h.push({column:k,boundary:"start"});h.push(...e);(e=b.layout.cols.next(e[e.length-1].column))&&h.push({column:e,boundary:"start"});e=[];(k=b.layout.rows.Lc(d[0].va))&&
e.push({va:k,boundary:"start"});e.push(...d);(d=b.layout.rows.next(d[d.length-1].va))&&e.push({va:d,boundary:"start"});for(const q of h){h=(d="start"===q.boundary?q.column:void 0)?b.layout.cols.Lc(d):b.layout.cols.last();for(const r of e){var l="start"===r.boundary?r.va:void 0;k=l?b.layout.rows.Lc(l):b.layout.rows.last();var m=d&&l&&c.get(`${d.id}:${l.id}`),n=d&&k&&c.get(`${d.id}:${k.id}`);l=h&&l&&c.get(`${h.id}:${l.id}`);var p=h&&k&&c.get(`${h.id}:${k.id}`);k="end"===q.boundary?null===l||void 0===
l?void 0:l.Ta:null===m||void 0===m?void 0:m.Aa;m="end"===r.boundary?null===n||void 0===n?void 0:n.Ma:null===m||void 0===m?void 0:m.Ba;n="end"===q.boundary?null===p||void 0===p?void 0:p.Ta:null===n||void 0===n?void 0:n.Aa;l="end"===r.boundary?null===p||void 0===p?void 0:p.Ma:null===l||void 0===l?void 0:l.Ba;p=__c.LGa({Ba:n,Ma:k,Aa:l,Ta:m},a);let t;switch(p){case "blockStart":t=n;break;case "blockEnd":t=k;break;case "inlineStart":t=l;break;case "inlineEnd":t=m;break;default:t=void 0}const {height:u,
width:v}=1===(null===t||void 0===t?void 0:t.mc)?{height:t.weight,width:t.weight}:{height:Math.max((null===l||void 0===l?void 0:l.weight)||0,(null===m||void 0===m?void 0:m.weight)||0),width:Math.max((null===n||void 0===n?void 0:n.weight)||0,(null===k||void 0===k?void 0:k.weight)||0)};g.set(c5(q,r),__c.FI(p,u/2,v/2))}}return g},d5=function(a,b,c,d,e){if(a&&b){var f=b.Ut?a.Ut?void 0:a:b;return __c.HI(b.borderStyle,a.borderStyle,d,c,e,null===f||void 0===f?void 0:f.borderStyle)}return null!==(f=null===
a||void 0===a?void 0:a.borderStyle)&&void 0!==f?f:null===b||void 0===b?void 0:b.borderStyle},GPb=function(a,b,c){var d=b&&c&&a.layout.cells.get(c,b),e,f,g=b&&c?a.layout.attrs.get(Gg({I6:void 0,RQ:void 0,M6:void 0}),null!==(e=null===d||void 0===d?void 0:d.span.bc)&&void 0!==e?e:c,null!==(f=null===d||void 0===d?void 0:d.span.Ub)&&void 0!==f?f:b)||{}:void 0;if(b&&c){b={color:a.qj.color,weight:a.qj.weight,mc:II(a.qj.Yd)};if(!g)return a.Dm?void 0:{borderStyle:b,Ut:!0};c=e5(g.I6);d=f5(g.RQ);g=g5(g.M6);
return null==c&&null==d&&null==g?a.Dm?void 0:{borderStyle:b,Ut:!0}:{borderStyle:{color:null!==c&&void 0!==c?c:b.color,weight:null!==d&&void 0!==d?d:b.weight,mc:g?II(g):b.mc},Ut:!1}}},HPb=function(a,b,c){var d=b&&c&&a.layout.cells.get(c,b),e,f,g=b&&c?a.layout.attrs.get(Gg({H6:void 0,QQ:void 0,L6:void 0}),null!==(e=null===d||void 0===d?void 0:d.span.bc)&&void 0!==e?e:c,null!==(f=null===d||void 0===d?void 0:d.span.Ub)&&void 0!==f?f:b)||{}:void 0;if(b&&c){b={color:a.qj.color,weight:a.qj.weight,mc:II(a.qj.Yd)};
if(!g)return a.Dm?void 0:{borderStyle:b,Ut:!0};c=e5(g.H6);d=f5(g.QQ);g=g5(g.L6);return null==c&&null==d&&null==g?a.Dm?void 0:{borderStyle:b,Ut:!0}:{borderStyle:{color:null!==c&&void 0!==c?c:b.color,weight:null!==d&&void 0!==d?d:b.weight,mc:g?II(g):b.mc},Ut:!1}}},IPb=function(a,b,c){var d=b&&c&&a.layout.cells.get(c,b),e,f,g=b&&c?a.layout.attrs.get(Gg({K6:void 0,TQ:void 0,O6:void 0}),null!==(e=null===d||void 0===d?void 0:d.span.bc)&&void 0!==e?e:c,null!==(f=null===d||void 0===d?void 0:d.span.Ub)&&void 0!==
f?f:b)||{}:void 0;if(b&&c){b={color:a.qj.color,weight:a.qj.weight,mc:II(a.qj.Yd)};if(!g)return a.Dm?void 0:{borderStyle:b,Ut:!0};c=e5(g.K6);d=f5(g.TQ);g=g5(g.O6);return null==c&&null==d&&null==g?a.Dm?void 0:{borderStyle:b,Ut:!0}:{borderStyle:{color:null!==c&&void 0!==c?c:b.color,weight:null!==d&&void 0!==d?d:b.weight,mc:g?II(g):b.mc},Ut:!1}}},JPb=function(a,b,c){var d=b&&c&&a.layout.cells.get(c,b),e,f,g=b&&c?a.layout.attrs.get(Gg({J6:void 0,SQ:void 0,N6:void 0}),null!==(e=null===d||void 0===d?void 0:
d.span.bc)&&void 0!==e?e:c,null!==(f=null===d||void 0===d?void 0:d.span.Ub)&&void 0!==f?f:b)||{}:void 0;if(b&&c){b={color:a.qj.color,weight:a.qj.weight,mc:II(a.qj.Yd)};if(!g)return a.Dm?void 0:{borderStyle:b,Ut:!0};c=e5(g.J6);d=f5(g.SQ);g=g5(g.N6);return null==c&&null==d&&null==g?a.Dm?void 0:{borderStyle:b,Ut:!0}:{borderStyle:{color:null!==c&&void 0!==c?c:b.color,weight:null!==d&&void 0!==d?d:b.weight,mc:g?II(g):b.mc},Ut:!1}}},e5=function(a){return null==a||"inherit"===a?void 0:a},f5=function(a){return null==
a||"inherit"===a?void 0:Number(a.split("px")[0])},g5=function(a){return null==a||"inherit"===a?void 0:a.split(" ").map(b=>{b=Number(b);return 0<b?b:void 0}).filter(__c.zb)},h5=function(a,b,c){let d=0;for(;null!=a&&a!==b;)(a=c.next(a))&&d++;return d},KPb=function(a,b){return(null===a||void 0===a?void 0:a.Ma)===(null===b||void 0===b?void 0:b.Ma)&&(null===a||void 0===a?void 0:a.Ba)===(null===b||void 0===b?void 0:b.Ba)&&(null===a||void 0===a?void 0:a.Ta)===(null===b||void 0===b?void 0:b.Ta)&&(null===
a||void 0===a?void 0:a.Aa)===(null===b||void 0===b?void 0:b.Aa)},NPb=function(a){const b={transform:"translate(-1000px, -1000px) scale(0)"},c={sDa:b,Or:b,Ha:{},nq:{}},d=i5(()=>a.rG.style||c,g=>{var h;Object.assign(a.m7.style,g.sDa);Object.assign(a.cR.style,g.Or);Object.assign(a.BH.style,g.Ha);Object.assign(a.ZD.style,g.nq);g=null===g||void 0===g?void 0:null===(h=g.Ha)||void 0===h?void 0:h.textDecoration;a.BH.classList.toggle("OQx3PQ","underline"===g);a.BH.classList.toggle("_99ezUA","line-through"===
g);a.BH.classList.toggle("kppAqQ","underline line-through"===g)},{fireImmediately:!0,equals:LPb}),e=i5(()=>a.N_&&a.sKa,g=>{a.BH.classList.toggle("_84KvRA",!g);a.m7.classList.toggle("_84KvRA",!g)},{fireImmediately:!0}),f=i5(()=>a.renderer,g=>{a.W7&&"react"!==(null===g||void 0===g?void 0:g.type)?(a.W7=void 0,a.W1.remove()):a.ZD.innerHTML="";switch(null===g||void 0===g?void 0:g.type){case "react":a.W7=MPb(g.node,a.W1);a.ZD.appendChild(a.W1);break;case "dom":g.render(a.ZD);break;case void 0:break;default:throw new F(g);
}a.Tra()},{fireImmediately:!0});return()=>{d();e();f()}},LPb=function(a,b){return JSON.stringify(a)===JSON.stringify(b)},PPb=function(a){const b=a.Wz,c=a.iG,d=a.kD,e=a.CVa,f=new OPb(c);return g=>Q4(j5,{...g,kD:d,iG:c,Wz:b,Apa:f,CVa:null===e||void 0===e?void 0:e.get()})},gPb=({tf:a,$P:b})=>c=>(0,__c.N)(__c.klb,{...c,tf:a,$P:b}),k5=__webpack_require__(443763),QPb=k5.Fragment,Q4=k5.jsx,l5=k5.jsxs;var V4=__webpack_require__(214645).Pi;var m5=__webpack_require__(875604),n5=m5.Component,tPb=m5.PureComponent,W4=m5.useCallback,$4=m5.useEffect,RPb=m5.useLayoutEffect,U4=m5.useMemo,o5=m5.useRef,SPb=m5.useState;var p5=__webpack_require__(519427),q5=p5.action,a5=p5.autorun,r5=p5.comparer,b5=p5.computed,TPb=p5.createAtom,s5=p5.observable,i5=p5.reaction,UPb=p5.untracked;var t5=__webpack_require__(46239).gn;var VPb=__webpack_require__,WPb=VPb(993864),S4=VPb.n_x(WPb)();var XPb=__webpack_require__(358579).Z;var u5=__webpack_require__(635872),v5=u5.Om,w5=u5.kq,YPb=u5.YN;var MPb=__webpack_require__(204358).createPortal;var ZPb=V4(a=>{var b,c,d="rtl"===a.sheet.direction;d={H2wykw:!d,UweldA:d};const [e]=SPb(()=>mz()),f={get:W4(()=>{var g;const h=null===e||void 0===e?void 0:null===(g=e.current)||void 0===g?void 0:g.getBoundingClientRect();var k,l;g={top:0,left:0,width:null!==(k=null===h||void 0===h?void 0:h.width)&&void 0!==k?k:0,height:null!==(l=null===h||void 0===h?void 0:h.height)&&void 0!==l?l:0};return __c.Aw(g)},[e])};return l5("div",{className:S4("nMvVqA",d),children:[l5("div",{ref:XPb(a.Nd,e),className:"_0YOFPg",
children:[Q4(a.Xp,{...a,viewport:f}),Q4("div",{className:S4("Gdl7fQ",d),children:null===(c=a.rAa)||void 0===c?void 0:null===(b=c.get())||void 0===b?void 0:b.map((g,h)=>Q4(g,{},h))})]}),"visible"===a.tvb&&l5(QPb,{children:[Q4("div",{className:S4("_32sKQw",d),children:Q4(a.zYa,{...a})}),Q4("div",{className:S4("xdIsTQ",d),children:Q4(a.DYa,{...a})}),Q4("div",{className:S4("rsTRSA",d),children:Q4(a.BYa,{...a})})]})]})}),$Pb=V4(a=>{a=a.content;__c.w("text2"===a.type||"text3"===a.type);switch(a.type){case "text2":return a.value.W;
case "text3":return __c.mr.ua(a.value).cells.W();default:throw new F(a);}});var hPb=a=>__c.jGa((b,c)=>{const d=b.content;b=b.context;if(d.value.isEmpty)for(;c.lastChild;)c.lastChild.remove();else({wi:b}=__c.Zf(__c.Fg,b.attrs)),"wrap"===b&&(c=c.appendChild(document.createElement("div")),c.className="dt4Dlg"),a.render({container:c,text:d.value,Na:void 0,writingMode:1,Fd:"start",rg:aQb(d,b)})}),aQb=v5((a,b)=>{if("wrap"===b)return[];a=a.value.W.split("\n").map(c=>c.length+1);a.pop();return a},{equals:r5.structural});var R4=class extends n5{static j(a){Q(a,{wi:b5})}constructor(...a){super(...a);R4.j(this)}get wi(){return __c.Zf(__c.Fg,this.props.context.attrs).wi}render(){var a=this.props.content;const b=this.props.context;if(a.value.isEmpty)return null;a=Q4(this.props.qh,{content:a,va:b.container.va,col:b.container.column,wi:this.wi});return"wrap"===this.wi?Q4("div",{className:"dt4Dlg",children:a}):a}};R4=t5([Kc],R4);var mPb=class{gp({size:a,scale:b,gra:c}){b=c?Math.max(c,b):b;return"large"===a?__c.M_*b:__c.tBb*b}constructor(){this.x$a=v5((a,b)=>{var c,d;b=b.get();return null!=b&&a.layout.rows.count()===((null===(c=b.rows)||void 0===c?void 0:c.size)||0)&&a.layout.cols.count()===((null===(d=b.columns)||void 0===d?void 0:d.size)||0)});this.dva=w5(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.columns)||[])},{equals:__c.us});this.fva=w5(a=>{var b;return new Set((null===(b=a.get())||void 0===b?
void 0:b.rows)||[])},{equals:__c.us});this.r8a=v5((a,b)=>{var {cells:c}=b.get()||{};if(!c)return new Set;if(0<this.fva(b).size)return new Set(a.layout.cols);b=this.dva(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.va,e.column);for(const f of cPb(c?c.span.Ub:e.column,c?c.span.Mc:e.column,a.layout.cols))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.us});this.s8a=v5((a,b)=>{var {cells:c}=b.get()||{};if(!c)return new Set;if(0<this.dva(b).size)return new Set(a.layout.rows);b=this.fva(b);
const d=new Set;for(const e of c){c=a.layout.cells.get(e.va,e.column);for(const f of cPb(c?c.span.bc:e.va,c?c.span.Yc:e.va,a.layout.rows))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.us})}};var bQb=parseInt("4px",10)||4,X4=class extends n5{static j(a){Q(a,{Cd:b5,Cq:b5,D3:b5})}get Cd(){return"rtl"===this.props.sheet.direction}get Cq(){var a;const b=null===(a=this.props.fp)||void 0===a?void 0:a.get();if(null!=b&&0!==b.length)return new __c.lF(b)}get D3(){var a,b,c;return null===(b=(c=this.props).Xna)||void 0===b?void 0:null===(a=b.call(c))||void 0===a?void 0:a.get()}render(){return Q4(__c.nA,{pq:"light",light:"light",ut:"light",dark:"light",children:this.i1a})}constructor(...a){super(...a);
X4.j(this);this.onMouseMove=q5(b=>{const {onMouseMove:c,sheet:d,Ed:e=1}=this.props;null===c||void 0===c?void 0:c(b,d,"column",e)});this.onMouseLeave=q5(b=>{var c,d;null===(c=(d=this.props).onMouseLeave)||void 0===c?void 0:c.call(d,b)});this.oQa=(b,c,d)=>{const {sheet:e,gp:f,KE:g,Ed:h=1,Td:k=1}=this.props,l={jNbTIg:!this.Cd,gtA7Dw:this.Cd},m=(null===d||void 0===d?0:d.sticky)?this.Cd?{right:0}:{left:0}:void 0;var n;const p=(null===d||void 0===d?0:d.sticky)?null!==(n=this.D3)&&void 0!==n?n:m:void 0;
let q=-1;return l5("div",{style:p,className:S4("Vt2_4w",l,{Tn3nUw:null===d||void 0===d?void 0:d.sticky}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:[e.layout.cols.map(r=>{q++;if(!(b&&0>e.layout.cols.Pe(r,b)||c&&0<e.layout.cols.Pe(r,c)))return Q4(cQb,{col:r,label:__c.DC(q),gp:f,KE:g,Ed:h,Td:k},r.id)}),(null===d||void 0===d?void 0:d.sticky)&&Q4("div",{style:{width:bQb*h},className:S4("HBvlug","ru3tFQ",l)})]})};this.i1a=b=>{var c;const d=this.props.sheet,e=d.view.freeze.DH?
d.layout.Id.get(d.view.freeze.DH):void 0,f={jNbTIg:!this.Cd,gtA7Dw:this.Cd};return l5("div",{ref:null===(c=this.Cq)||void 0===c?void 0:c.Yl,className:S4("xhBZaw",f,b.className),children:[e&&this.oQa(void 0,e,{sticky:!0}),this.oQa(e?d.cols.next(e):void 0)]})}}};X4=t5([Kc],X4);
var Y4=class extends n5{static j(a){Q(a,{Cd:b5,Cq:b5,D3:b5})}get Cd(){return"rtl"===this.props.sheet.direction}get Cq(){var a;const b=null===(a=this.props.fp)||void 0===a?void 0:a.get();if(null!=b&&0!==b.length)return new __c.lF(b)}get D3(){var a,b,c;return null===(b=(c=this.props).Xna)||void 0===b?void 0:null===(a=b.call(c))||void 0===a?void 0:a.get()}render(){return Q4(__c.nA,{pq:"light",light:"light",ut:"light",dark:"light",children:this.Xgb})}constructor(...a){super(...a);Y4.j(this);this.onMouseMove=
q5(b=>{const {onMouseMove:c,sheet:d,Td:e=1}=this.props;null===c||void 0===c?void 0:c(b,d,"row",e)});this.onMouseLeave=q5(b=>{var c,d;null===(c=(d=this.props).onMouseLeave)||void 0===c?void 0:c.call(d,b)});this.sQa=(b,c,d)=>{const {sheet:e,gp:f,KE:g,Ed:h=1,Td:k=1}=this.props,l={jNbTIg:!this.Cd,gtA7Dw:this.Cd},m=(null===d||void 0===d?0:d.sticky)?{top:0}:void 0;var n;const p=(null===d||void 0===d?0:d.sticky)?null!==(n=this.D3)&&void 0!==n?n:m:void 0;let q=-1;return l5("div",{style:p,className:S4("_93roJg",
l,{Tn3nUw:null===d||void 0===d?void 0:d.sticky}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:[e.rows.map(r=>{q++;if(!(b&&0>e.rows.Pe(r,b)||c&&0<e.rows.Pe(r,c)))return Q4(dQb,{va:r,label:`${q+1}`,KE:g,gp:f,Ed:h,Td:k},r.id)}),(null===d||void 0===d?void 0:d.sticky)&&Q4("div",{style:{height:bQb*k},className:S4("HBvlug","koz2Hg")})]})};this.Xgb=b=>{var c;const d=this.props.sheet,e=d.view.freeze.RU?d.layout.Sd.get(d.view.freeze.RU):void 0,f={jNbTIg:!this.Cd,gtA7Dw:this.Cd};return l5("div",
{ref:null===(c=this.Cq)||void 0===c?void 0:c.Yl,className:S4("An9VeA",f,b.className),children:[e&&this.sQa(void 0,e,{sticky:!0}),this.sQa(e?d.rows.next(e):void 0)]})}}};Y4=t5([Kc],Y4);
var cQb=V4(a=>{const b=a.label,c=a.col,d=a.KE,e=a.gp,f=a.Ed;a=a.Td;const g=e(a),h=YPb(()=>d(c));return Q4("div",{className:S4("_83Rssw","d2uLIA",T4(h)),style:{width:c.width*f,height:g},children:Q4(jPb,{label:b,width:c.width,height:e(1),scale:a,bEa:h})})}),dQb=V4(a=>{const b=a.label,c=a.va,d=a.gp,e=a.KE,f=a.Ed;a=a.Td;const g=d(f),h=YPb(()=>e(c));return Q4("div",{className:S4("_83Rssw","JhBzyw",T4(h)),style:{width:g,height:c.height*a},children:Q4(jPb,{label:b,width:d(1),height:c.height,scale:f,bEa:h})})});var eQb='<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="6" cy="6" r="5.5"/></svg>';var fQb='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="12" cy="12" r="9.25" stroke-width="1.5"/></svg>';var kPb=__c.aS({Bo:eQb,medium:fQb});var Z4=class extends n5{static j(a){Q(a,{fe:b5.struct})}constructor(...a){super(...a);Z4.j(this)}render(){const a=this.props.element,b=this.props.fp,c=this.props.Nt,d=this.props.Qt,e=this.props.aa;return Q4(this.props.Xp,{sheet:a.config,container:this.props.container.Hl(a),Q6:"visible",fp:b,Nt:c,Qt:d,aa:e,fe:this.fe,qh:this.props.qh,cH:void 0})}get fe(){return __c.AB(this.props.element.$a,this.props.Ce)}};Z4=t5([Kc],Z4);var gQb=class{constructor(){this.zea=new WeakMap;this.E7a=a=>this.zea.get(a);this.VRa=(a,b)=>{this.zea.set(a,b)};this.U0a=(a,b)=>{const c=this.zea.get(a);c&&c.qa===b.qa&&c.Xb===b.Xb&&this.zea.delete(a)}}};var x5=parseInt("4px",10)||4,hQb=V4(({sheet:a,aa:b,range:c,Pv:d,Qv:e})=>{if(null!=c&&(d||e)){var f;b=null!==(f=null===b||void 0===b?void 0:b.get())&&void 0!==f?f:1;if(d&&e)return d=a.Ba(c.Yc)+c.Yc.height,a=a.Aa(c.Mc)+c.Mc.width,Q4("div",{style:{top:d*b,width:a*b,height:x5*b},className:S4("aX8dhQ","VGcLng")});if(d)return c=a.Aa(c.Mc)+c.Mc.width,Q4("div",{style:{left:c*b,width:x5*b,height:a.height*b},className:S4("aX8dhQ","gl1RPg")});if(e)return c=a.Ba(c.Yc)+c.Yc.height,Q4("div",{style:{top:c*b,width:a.width*
b,height:x5*b},className:S4("aX8dhQ","VGcLng")})}});var y5=({sheet:a,range:b,aa:c,children:d})=>{const e=P4();pPb({sheet:a,aa:c,range:b,Nd:e});return Q4("div",{ref:e,className:S4("nstn2A","rtl"===a.direction?"NgnL2Q":"f8jAGQ"),children:d})},iQb=({sheet:a,range:b,aa:c,children:d})=>{const e=P4();pPb({sheet:a,aa:c,range:b,Nd:e});a="rtl"===a.direction?"NgnL2Q":"f8jAGQ";return Q4("div",{className:S4("nstn2A",a,"_9sodyg"),children:Q4("div",{ref:e,className:S4("nstn2A",a),children:d})})};var rPb=V4(({sheet:a,children:b,AC:c})=>{const d=W4(f=>{c.zva(a,f)},[c,a]),e=W4(f=>{null!=f?c.DC.set(a,f):c.DC.delete(a)},[c,a]);return Q4(__c.rnb,{direction:"rtl"===a.config.direction?"rtl":"ltr",onScroll:d,CC:e,children:b})}),qPb=class{zva(a,b){this.onScroll&&this.onScroll(a);this.J2.set(a,b)}constructor(a){this.onScroll=a;this.DC=new WeakMap;this.J2=s5.map(new Map,{deep:!1});this.scrollTo=q5((b,c)=>{b=this.DC.get(b);null===b||void 0===b?void 0:b.scrollTo({left:Math.floor(c)})})}};var uPb=V4(a=>{const b=a.item,c=a.fp,d=a.Df,e=a.measureRef,f=a.aa,g=a.VJa,h=a.Xb,k=a.Nt,l=a.Qt,m=a.Xp,n=a.bL,p=a.qh,q=a.Ce,r=a.AC;a=U4(()=>__c.AB(b.$a,q),[b,q]);const t=U4(()=>V4(({sheet:v,range:x,Pv:y,Qv:z})=>Q4(y5,{sheet:v,range:x,aa:f,children:Q4(hQb,{sheet:v,aa:f,range:x,Pv:y,Qv:z})})),[f]),u=f.get();$4(()=>a5(()=>{var v=b.config.view.freeze.DH?b.config.layout.Id.get(b.config.view.freeze.DH):void 0;if(null!=v){var x=Math.min(h.width,b.F*u);if(b.config.Aa(v)+v.width>x){if(v=r.DC.get(b))v.style.overflowX=
"hidden"}else if(v=r.DC.get(b))v.style.overflowX="scroll"}}),[b,h.width,r,u]);return Q4("div",{ref:e,className:"E8r86A",style:{width:Math.min(h.width,b.F*u)},children:Q4(n,{sheet:b,children:Q4("div",{ref:g,className:"cXTiJA",style:{width:b.F*u,height:b.P*u},children:Q4(m,{container:d.Il(b),sheet:b.config,Q6:"visible",fp:c,aa:f,Nt:k,Qt:l,fe:a,qh:p,cH:t})})})})});var jQb=V4(({page:a,range:b,sC:c})=>{const d=wPb(a.sheet,b);return Q4("div",{className:"Gi9pfA",children:a.elements.map((e,f)=>null==d?c(e,f):__c.yw(__c.Aw(e)).Rq(d)&&c(e,f))})});var kQb=new __c.IS,z5=a=>__c.M_*a,lQb=()=>"primary-default",xPb=V4(({container:a,fp:b,Nt:c,Qt:d,TZ:e,aa:f,viewport:g,tib:h,Xp:k,qh:l,sC:m,Lda:n,Qnb:p,Pmb:q,Omb:r})=>{const t=a.page,u=U4(()=>V4(({sheet:v,range:x,Pv:y,Qv:z})=>l5(QPb,{children:[Q4(y5,{sheet:t.sheet,range:x,aa:f,children:Q4(hQb,{sheet:v,aa:f,range:x,Pv:y,Qv:z})}),l5(iQb,{sheet:t.sheet,range:x,aa:f,children:[p&&Q4(p,{}),m&&Q4(jQb,{page:t,sC:m,range:x}),r&&Q4(r,{}),n&&n()]}),q&&x&&Q4(y5,{sheet:t.sheet,range:x,aa:f,children:Q4(q,{range:x})})]})),
[t,f,p,m,r,n,q]);return h?Q4(mQb,{container:a,viewport:g,aa:f,fp:b,Nt:c,Qt:d,Xp:k,qh:l,cH:u}):Q4(k,{sheet:t.sheet,container:a,Q6:"hidden",fp:b,Nt:c,Qt:d,TZ:e,aa:f,viewport:g,qh:l,cH:u})}),mQb=V4(a=>{const b=a.container,c=a.aa,d=a.viewport,e=a.fp,f=a.Nt,g=a.Qt,h=a.Xp,k=a.qh;a=a.cH;const l=b.page,m="rtl"===l.sheet.direction,n=o5(null),p=o5(null),q=o5(null);$4(()=>{const y=A5({sheet:l.sheet,efa:!0,ffa:!0,aa:c,viewport:d});return i5(()=>null===y||void 0===y?void 0:y.get(),z=>{const A=n.current;if(z&&
A){var C="rtl"===l.sheet.direction,E;A.style.position=null!==(E=z.position)&&void 0!==E?E:"sticky";var H;A.style.top=null!==(H=z.top)&&void 0!==H?H:"0px";var J,I;C?A.style.right=null!==(J=z.right)&&void 0!==J?J:"0px":A.style.left=null!==(I=z.left)&&void 0!==I?I:"0px";var M;A.style.transform=null!==(M=z.transform)&&void 0!==M?M:""}})},[l.sheet,c,d]);$4(()=>{const y=A5({sheet:l.sheet,efa:!1,ffa:!0,aa:c,viewport:d});return i5(()=>null===y||void 0===y?void 0:y.get(),z=>{const A=q.current;if(z&&A){var C;
A.style.position=null!==(C=z.position)&&void 0!==C?C:"sticky";var E;A.style.top=null!==(E=z.top)&&void 0!==E?E:"0px";var H;A.style.transform=null!==(H=z.transform)&&void 0!==H?H:""}})},[l.sheet,c,d]);$4(()=>{const y=A5({sheet:l.sheet,efa:!0,ffa:!1,aa:c,viewport:d});return i5(()=>null===y||void 0===y?void 0:y.get(),z=>{const A=p.current;if(z&&A){var C="rtl"===l.sheet.direction,E;A.style.position=null!==(E=z.position)&&void 0!==E?E:"sticky";var H,J;C?A.style.right=null!==(H=z.right)&&void 0!==H?H:"0px":
A.style.left=null!==(J=z.left)&&void 0!==J?J:"0px";var I;A.style.transform=null!==(I=z.transform)&&void 0!==I?I:""}})},[l.sheet,c,d]);const r=W4((y,z,A)=>A5({sheet:y,efa:z,ffa:A,aa:c,viewport:d}),[c,d]),t=U4(()=>r?()=>r(l.sheet,!0,!1):void 0,[r,l.sheet]),u=U4(()=>r?()=>r(l.sheet,!1,!0):void 0,[r,l.sheet]);var v;const x=null!==(v=null===c||void 0===c?void 0:c.get())&&void 0!==v?v:1;return l5("div",{className:"OsKKIQ",children:[Q4("div",{className:"VDFv_A",children:Q4(h,{sheet:l.sheet,container:b,Q6:"hidden",
fp:e,Nt:f,Qt:g,TZ:r,aa:c,viewport:d,qh:k,cH:a})}),Q4("div",{ref:n,className:"_688KWg",children:Q4(lPb,{Cd:m,cJa:!1,gp:z5,scale:x})}),Q4("div",{ref:q,className:"m0cT1w",children:Q4(X4,{sheet:l.sheet,Ed:x,Td:x,gp:z5,KE:lQb,yF:kQb,Xna:t})}),Q4("div",{ref:p,className:"zm537g",children:Q4(Y4,{sheet:l.sheet,Ed:x,Td:x,gp:z5,KE:lQb,yF:kQb,Xna:u})})]})}),A5=({sheet:a,efa:b,ffa:c,aa:d,viewport:e})=>b5(()=>{var f=null===e||void 0===e?void 0:__c.Iw(e.get()),g;const h=null!==(g=null===d||void 0===d?void 0:d.get())&&
void 0!==g?g:1;if(!f)return{};g={};f=new cw(f.left,f.top);const k="rtl"===a.direction;g.position="relative";c&&(g.top="0px");b&&(k?g.right="0px":g.left="0px");g.transform=`translate(${b?f.x*h:0}px, ${c?f.y*h:0}px)`;return g});var c5=(a,b)=>`${a.column.id}-${a.boundary}:${b.va.id}-${b.boundary}`,oQb=class{constructor(){this.dSa=nQb;this.A7a=w5(a=>{const b=new Map;let c=0;a.layout.rows.forEach(d=>{const e=c,f=e+d.height;b.set(d,{start:e,end:f});c=f});return b});this.T6a=w5(a=>{const b=new Map;var c="rtl"===a.direction;const d=c?-1:1;let e=0;c&&(c=a.layout.cols.last(),e=null!=c?a.Aa(c)+c.width:0);a.layout.cols.forEach(f=>{const g=e,h=g+f.width*d;b.set(f,{start:g,end:h});e=h});return b})}},pQb=class{constructor(){this.Hgb=
v5((a,b,c)=>{const d=a.layout.cells.get(c,b);var e,f,g=h5(null!==(e=null===d||void 0===d?void 0:d.span.Ub)&&void 0!==e?e:b,null!==(f=null===d||void 0===d?void 0:d.span.Mc)&&void 0!==f?f:b,a.layout.cols),h,k;e=h5(null!==(h=null===d||void 0===d?void 0:d.span.bc)&&void 0!==h?h:c,null!==(k=null===d||void 0===d?void 0:d.span.Yc)&&void 0!==k?k:c,a.layout.rows);var l=d?c===d.span.bc:!0;const m=d?c===d.span.Yc:!0,n=d?b===d.span.Ub:!0;f=d?b===d.span.Mc:!0;if(n||f||l||m){h={};var p=a.layout.rows.Lc(c),q=a.layout.rows.next(c),
r=a.layout.cols.Lc(b);k=a.layout.cols.next(b);if(l){l=GPb(a,b,c);const Y=b&&p&&a.layout.cells.get(p,b);p=b&&p&&HPb(a,b,p);var t,u;const ka=h5(null!==(t=null===Y||void 0===Y?void 0:Y.span.Ub)&&void 0!==t?t:b,null!==(u=null===Y||void 0===Y?void 0:Y.span.Mc)&&void 0!==u?u:b,a.layout.cols);var v,x;t=a.layout.cols.Pe(null!==(v=null===d||void 0===d?void 0:d.span.Ub)&&void 0!==v?v:b,null!==(x=null===Y||void 0===Y?void 0:Y.span.Ub)&&void 0!==x?x:b);h.Ba=d5(l,p,g,ka,t)}if(m){v=HPb(a,b,c);x=b&&q&&a.layout.cells.get(q,
b);t=b&&q&&GPb(a,b,q);var y,z;u=h5(null!==(y=null===x||void 0===x?void 0:x.span.Ub)&&void 0!==y?y:b,null!==(z=null===x||void 0===x?void 0:x.span.Mc)&&void 0!==z?z:b,a.layout.cols);var A,C;y=a.layout.cols.Pe(null!==(A=null===d||void 0===d?void 0:d.span.Ub)&&void 0!==A?A:b,null!==(C=null===x||void 0===x?void 0:x.span.Ub)&&void 0!==C?C:b);h.Ma=d5(v,t,g,u,y)}if(n){g=IPb(a,b,c);A=r&&c&&a.layout.cells.get(c,r);C=r&&c&&JPb(a,r,c);var E,H;y=h5(null!==(E=null===A||void 0===A?void 0:A.span.bc)&&void 0!==E?
E:c,null!==(H=null===A||void 0===A?void 0:A.span.Yc)&&void 0!==H?H:c,a.layout.rows);var J,I;E=a.layout.rows.Pe(null!==(J=null===d||void 0===d?void 0:d.span.bc)&&void 0!==J?J:c,null!==(I=null===A||void 0===A?void 0:A.span.bc)&&void 0!==I?I:c);h.Aa=d5(g,C,e,y,E)}if(f){b=JPb(a,b,c);J=k&&c&&a.layout.cells.get(c,k);I=k&&c&&IPb(a,k,c);var M,P;E=h5(null!==(M=null===J||void 0===J?void 0:J.span.bc)&&void 0!==M?M:c,null!==(P=null===J||void 0===J?void 0:J.span.Yc)&&void 0!==P?P:c,a.layout.rows);var R,V;a=a.layout.rows.Pe(null!==
(R=null===d||void 0===d?void 0:d.span.bc)&&void 0!==R?R:c,null!==(V=null===J||void 0===J?void 0:J.span.bc)&&void 0!==V?V:c);h.Ta=d5(b,I,e,E,a)}return h}},{equals:KPb});this.V1a=(a,b,c)=>{const d=new Map;a.forEach(({Aa:e,Ba:f,Ta:g,Ma:h},k)=>{e&&d.set(e.color,(d.get(e.color)||0)+1);f&&d.set(f.color,(d.get(f.color)||0)+1);g&&c&&k.includes(c.id)&&d.set(g.color,(d.get(g.color)||0)+1);h&&b&&k.includes(b.id)&&d.set(h.color,(d.get(h.color)||0)+1)});return d}}},nQb=new pQb,EPb=new oQb;var OPb=class{constructor(a){this.iG=a;this.G0a=__c.kU;this.h7a=v5((b,c,d,e)=>{d=d.get();const f=new WeakMap;for(let p=0;p<d.length;p++){var g=d[p],h=this.b7a(b,c,g);if(h){switch(h){case "start":case "justify":var k=d[p+1];if(null==k||!DI(b,c,k))continue;break;case "center":k=d[p+1];if(null==k||!DI(b,c,k))continue;k=d[p-1];if(null==k||!DI(b,c,k))continue;break;case "end":k=d[p-1];if(null==k||!DI(b,c,k))continue;break;default:throw new F(h);}if(k=e(c,g)){var l=k.width+("center"===h?0:this.G0a);if(!(g.width>
l)){switch(h){case "start":case "justify":h=b.Aa(g);k=h+l;break;case "center":k=b.Aa(g)+g.width/2;h=k-l/2;k+=l/2;break;case "end":k=b.Aa(g)+g.width;h=k-l;break;default:throw new F(h);}for(l=d.indexOf(g);0<=l;l--){var m=d[l];const q=0>l-1||DI(b,c,d[l-1]);var n;if(n=m===g||DI(b,c,m))n=b.Aa(m),n=h<n&&n<k;if(n&&q)f.set(m,1);else break}for(g=d.indexOf(g)+1;g<d.length;g++){l=d[g];if(m=DI(b,c,l))m=b.Aa(l),m=h<m&&m<k;if(m)f.set(l,1);else break}}}}}return f});this.b7a=(b,c,d)=>{var e,f;const g=b.layout.cells.get(c,
d);if(g&&(g.ref.content.ref||g.ref.La.ref)&&g.span.bc===g.span.Yc&&g.span.Ub===g.span.Mc){var {wi:h,textAlign:k}=__c.Zf(__c.Fg,b.layout.attrs.get(Gg({wi:void 0,textAlign:void 0}),c,d)||{});if("overflow"===h){var l=this.iG.pB(b,c,d);return __c.lGa(k,null===(e=g.ref.content.ref)||void 0===e?void 0:e.type,null===(f=g.ref.La.ref)||void 0===f?void 0:f.type,l?()=>l.Hn.type:void 0)}}}}};var qQb=V4(function(a){const b=a.sheet;var c=a.Up;const d=a.tlb,e=a.aa,f=a.Apa,g=a.R6a;a=a.overflow;const h=P4();RPb(()=>a5(()=>{const p=D(h.current);var q;const r=null!==(q=null===e||void 0===e?void 0:e.get())&&void 0!==q?q:1;q=b.height;p.style.width=`${b.width*r}px`;p.style.height=`${q*r}px`}),[h,e,b]);const k=W4(p=>f.h7a(b,p,d,g),[f,b,d,g]);var l=W4((p,q)=>{var r,t;return null!==(t=null===(r=k(p))||void 0===r?void 0:r.get(q))&&void 0!==t?t:0},[k]);c=FPb(b,c,d,l);l=b.width;const m=b.height,n="rtl"===
b.direction;return Q4("svg",{ref:h,role:"presentation",className:S4("c6a1eQ",{H_CtIQ:!n,_8_56PQ:n,_3NnFzw:"visible"===a,JMH1ng:"hidden"===a}),viewBox:`0 0 ${l} ${m}`,strokeLinecap:"butt",strokeLinejoin:"miter",children:c.map(({lines:p,color:q,weight:r,Xj:t,Yj:u})=>Q4("path",{stroke:q,strokeDasharray:t,strokeDashoffset:u,strokeWidth:r,d:p.map(({p1:v,p2:x})=>`M ${v.x} ${v.y} L ${x.x} ${x.y}`).join(" ")},`${q}-${r}-${t}-${u}`))})});var rQb=class{get size(){return this.Kea}get([a,b]){return(a=this.hF.get(a))?a.get(b):void 0}has([a,b]){a=this.hF.get(a);return null==a?!1:a.has(b)}set([a,b],c){let d=this.hF.get(a);null==d&&(d=new Map,this.hF.set(a,d));d.set(b,c);this.Kea++;return this}clear(){this.hF.clear();this.Kea=0}delete([a,b]){const c=this.hF.get(a);if(null==c||!c.delete(b))return!1;this.Kea--;0===c.size&&this.hF.delete(a);return!0}forEach(a){for(const [b,c]of this.hF)for(const [d,e]of c)a([b,d],e)}*[Symbol.iterator](){for(const [a,
b]of this.hF)for(const [c,d]of b)yield[[a,c],d]}constructor(){this.Kea=0;this.hF=new Map}};var C5=class extends n5{static j(a){Q(a,{i9:b5,ZUa:b5})}render(){var a;const {BZ:b,...c}=this.props,d=this.props.sheet;return l5("div",{ref:this.gSa,className:S4("ZTz_iA","ltr"===d.direction?"TA4X7w":"WvuqMw"),children:[(null===b||void 0===b?void 0:b.JCa)&&Q4(B5,{...c,sheet:d,range:b.JCa.range,Pv:!0,Qv:!0,className:"_0C8M3w",q7:this.i9}),(null===b||void 0===b?void 0:b.OVa)&&Q4(B5,{...c,sheet:d,range:b.OVa.range,Pv:!1,Qv:!0,className:"_7n44yg",q7:this.i9}),(null===b||void 0===b?void 0:b.fJa)&&Q4(B5,
{...c,sheet:d,range:b.fJa.range,Pv:!0,Qv:!1,className:"fF5r6w",q7:this.i9}),(null===b||void 0===b?void 0:b.wya)&&Q4(B5,{...c,sheet:d,range:null===b||void 0===b?void 0:null===(a=b.wya)||void 0===a?void 0:a.range,Pv:!1,Qv:!1,className:"llILYw",q7:this.ZUa})]})}componentDidMount(){const a=a5(()=>{var b=this.props,c=b.aa;b=b.sheet;const d=this.gSa.current;d&&(c=c?c.get():1,d.style.width=`${b.width*c}px`,d.style.height=`${b.height*c}px`)});__c.wc(this,[a])}get i9(){return{type:"excluded"}}get ZUa(){return{type:"hidden",
isVisible:this.F0a}}constructor(...a){super(...a);C5.j(this);this.gSa=mz();this.F0a=(b,c)=>{var d;const e=this.props.sheet;var f=this.props.BZ;f=null===f||void 0===f?void 0:null===(d=f.wya)||void 0===d?void 0:d.range;return e.layout.cols.has(b)&&e.layout.rows.has(c)?null==f?!0:0>=e.layout.cols.Pe(f.Ub,b)&&0>=e.layout.cols.Pe(b,f.Mc)&&0>=e.layout.rows.Pe(f.bc,c)&&0>=e.layout.rows.Pe(c,f.Yc):!1}}};C5=t5([Kc],C5);
var B5=class extends n5{static j(a){Q(a,{Nva:b5,bounds:b5})}get Nva(){const a=this.props.viewport,b=this.props.Pv,c=this.props.Qv;return null==a||!b&&!c?a:b5(()=>{const d=__c.Iw(a.get());return __c.Aw({top:c?0:d.top,left:b?0:d.left,width:d.width,height:d.height})})}render(){const a=this.props.sheet,b=this.props.container,c=this.props.range,d=this.props.q7,e=this.props.cH,f=this.props.Pv,g=this.props.Qv;return l5("div",{ref:this.eta,className:S4("i0YQww",this.props.className),children:[Q4("div",{ref:this.EOa,
className:"vUKoKg",children:Q4("div",{ref:this.FOa,children:Q4(D5,{sheet:a,container:b,bounds:"hidden"===(null===d||void 0===d?void 0:d.type)?void 0:c,N_:"hidden"===(null===d||void 0===d?void 0:d.type)?d.isVisible:void 0,fp:this.props.fp,kD:this.props.kD,qh:this.props.qh,lY:this.props.lY,aa:this.props.aa,Up:this.Up,xga:this.xga,wR:this.wR})})}),Q4(this.Bha,{}),e&&Q4(e,{sheet:a,range:c,Pv:f,Qv:g})]})}componentDidMount(){const a=a5(()=>{var g=this.props,h=g.aa,k=g.sheet;const l=g.range;var m=this.eta.current;
const n=this.EOa.current;g=this.FOa.current;h=h?h.get():1;const p=l?k.Aa(l.Mc)+l.Mc.width-k.Aa(l.Ub):k.width,q=l?k.Ba(l.Yc)+l.Yc.height-k.Ba(l.bc):k.height;m&&(m.style.width=`${p*h}px`,m.style.height=`${q*h}px`);n&&(n.style.width=`${p*h}px`,n.style.height=`${q*h}px`);m="rtl"===k.direction;m=l?k.Aa(l.Ub)*h*(m?1:-1):0;k=l?-k.Ba(l.bc)*h:0;g&&(g.style.transform=`translate(${m}px, ${k}px)`)}),b=this.props.sheet;var c=this.props.TZ;const d=this.props.Pv,e=this.props.Qv,f=d||e?null===c||void 0===c?void 0:
c(b,d,e):void 0;c=a5(()=>{const g=this.eta.current;if(null!=g){var h=d||e?"sticky":"relative",k=e?"0px":"unset",l=d?"0px":"unset",m=d?"0px":"unset",n="rtl"===b.direction;if(null==f)g.style.position=h,g.style.top=k,g.style.left=n?"unset":l,g.style.right=n?m:"unset";else{const v=f.get();var p;g.style.position=null!==(p=v.position)&&void 0!==p?p:h;var q;g.style.top=null!==(q=v.top)&&void 0!==q?q:k;var r;g.style.left=n?"unset":null!==(r=v.left)&&void 0!==r?r:l;var t;g.style.right=n?null!==(t=v.right)&&
void 0!==t?t:m:"unset";var u;g.style.transform=null!==(u=v.transform)&&void 0!==u?u:"unset"}}});__c.wc(this,[a,c])}get bounds(){const a=this.props.sheet,b=this.props.range;if(a.layout.cols.empty||a.layout.rows.empty)return{Ub:void 0,Mc:void 0,bc:void 0,Yc:void 0};var c,d,e,f;return{Ub:null!==(c=null===b||void 0===b?void 0:b.Ub)&&void 0!==c?c:a.layout.cols.first(),Mc:null!==(d=null===b||void 0===b?void 0:b.Mc)&&void 0!==d?d:a.layout.cols.last(),bc:null!==(e=null===b||void 0===b?void 0:b.bc)&&void 0!==
e?e:a.layout.rows.first(),Yc:null!==(f=null===b||void 0===b?void 0:b.Yc)&&void 0!==f?f:a.layout.rows.last()}}constructor(...a){super(...a);B5.j(this);this.eta=mz();this.EOa=mz();this.FOa=mz();this.wR=new sQb;this.ulb=b5(()=>[...this.Up.get().keys()].sort((b,c)=>this.props.sheet.layout.rows.Pe(b,c)),{equals:__c.xs()});this.slb=b5(()=>[...this.xga.get().keys()].sort((b,c)=>this.props.sheet.layout.cols.Pe(b,c)),{equals:__c.xs()});this.Bha=V4(()=>Q4(this.props.yYa,{Up:this.ulb,tlb:this.slb,R6a:this.wR.Y6a,
range:this.props.range}));this.Up=b5(()=>{var b;const c=this.props.sheet;var d=this.props.aa,e=null===(b=this.Nva)||void 0===b?void 0:b.get();if(e&&(0>=e.height||0>=e.width))return new Map;b=this.bounds;d=d.get();var f=50*d;const g=e?e.tl.y-f:b.bc?c.Ba(b.bc):0;e=e?e.br.y+f:b.Yc?c.Ba(b.Yc)+b.Yc.height:0;f=new Map;for(let h=b.bc;null!=h&&null!=b.Yc&&0>=c.layout.rows.Pe(h,b.Yc);h=c.layout.rows.next(h)){const k=c.Ba(h);if(!(k+h.height<g)){if(k>e)break;f.set(h,k*d)}}return f},{equals:r5.shallow});this.xga=
b5(()=>{var b;const c=this.props.sheet;var d=this.props.aa,e=null===(b=this.Nva)||void 0===b?void 0:b.get();if(e&&(0>=e.height||0>=e.width))return new Map;b=this.bounds;d=d.get();var f=50*d;const g=e?e.tl.x-f:b.Ub?c.Aa(b.Ub):0;e=e?e.br.x+f:b.Mc?c.Aa(b.Mc)+b.Mc.width:0;f=new Map;for(let h=b.Ub;null!=h&&null!=b.Mc&&0>=c.layout.cols.Pe(h,b.Mc);h=c.layout.cols.next(h)){const k=c.Aa(h);if(!(k+h.width<g)){if(k>e)break;f.set(h,k*d)}}return f},{equals:r5.shallow})}};B5=t5([Kc],B5);
var sQb=class{constructor(){this.cells=new rQb;this.kua=(a,b,c)=>{let d=this.cells.get([a,b]);null==d&&(d=s5.box(void 0,{deep:!1}),this.cells.set([a,b],d));d.set(c);return()=>{const e=this.cells.get([a,b]);e===d&&(e.set(void 0),this.cells.delete([a,b]))}};this.Y6a=(a,b)=>{var c;let d=this.cells.get([a,b]);null==d&&(d=s5.box(void 0,{deep:!1}),this.cells.set([a,b],d));return null===(c=d.get())||void 0===c?void 0:c.vEa}}},D5=class extends n5{static j(a){Q(a,{IK:s5.shallow,Cq:b5,tCa:q5,a8:q5.bound})}get Cq(){var a;
const b=null===(a=this.props.fp)||void 0===a?void 0:a.get();if(null!=b&&0!==b.length)return new __c.lF(b)}render(){var a;return l5("div",{ref:XPb(this.Nd,null===(a=this.Cq)||void 0===a?void 0:a.Yl),children:[Q4("div",{ref:this.hka,className:"_5YlOqQ"}),Q4("div",{ref:this.jka,className:"_XCmKw"}),this.IK.map(b=>b.mfb)]})}componentDidMount(){const a=i5(()=>[this.props.sheet,this.props.xga.get(),this.props.Up.get()],([d,e,f],g)=>{[g]=g||[];d!==g&&(d=D(this.hka.current),g=D(this.jka.current),d.innerHTML=
"",g.innerHTML="",this.cza.length=0,this.IK.length=0);this.tCa(e,f)},{fireImmediately:!0}),b=a5(()=>{var d=this.props,e=d.aa;d=d.sheet;const f=this.Nd.current;f&&(e=e?e.get():1,f.style.width=`${d.width*e}px`,f.style.height=`${d.height*e}px`)}),c=this.IK.map(d=>NPb(d));__c.wc(this,[b,a,...c])}tCa(a,b){const c=D(this.hka.current),d=D(this.jka.current),e=[],f=new Map;for(const g of this.cza)b.has(g.va)?f.set(g.va,g):e.push(g);for(const [g,h]of b)b=f.get(g)||e.pop(),b||(b=new tQb(this.a8,g),c.appendChild(b.n7),
d.appendChild(b.p7),this.cza.push(b)),b.update(h,g,a);for(const g of e)g.hide()}a8(a,b){const c=this.props.lY,d=this.props.sheet,e=this.props.container,f=this.props.N_,g=this.props.wR;a=new uQb(this.props.kD,this.props.qh,c(a,b),d,a,b,e,f,g.kua);__c.wc(this,NPb(a));this.IK.push(a);return a}constructor(...a){super(...a);D5.j(this);this.Nd=mz();this.hka=mz();this.jka=mz();this.cza=[];this.IK=[]}};D5=t5([Kc],D5);
var tQb=class{static j(a){Q(a,{update:q5})}update(a,b,c){[this.n7,this.p7].forEach(d=>{d.style.transform=`translateY(${a}px)`;d.classList.add("FPpqvg")});this.va=b;for(const [d]of c)c=this.IK.get(d),c||(c=this.a8(d,b),this.IK.set(d,c),this.n7.appendChild(c.m7),this.p7.appendChild(c.cR)),c.update(b)}hide(){[this.n7,this.p7].forEach(a=>{a.style.transform="translate(-1000px, -1000px) scale(0)"})}constructor(a,b){tQb.j(this);this.a8=a;this.va=b;this.n7=document.createElement("div");this.p7=document.createElement("div");
this.IK=new Map}},uQb=class{static j(a){Q(a,{W7:s5.ref,va:s5.ref,update:q5,Av:b5,attrs:b5.struct,N_:b5,sKa:b5,Or:b5,renderer:b5,vEa:b5.struct})}update(a){a!==this.va&&(this.va=a,this.rG.va=a,this.fma&&this.fma(),this.fma=this.kua(this.va,this.col,this))}get mfb(){return this.W7}get Av(){const a=this.sheet.layout.cells.get(this.va,this.col);if(!a||a.span.bc===this.va&&a.span.Ub===this.col)return a?a.ref:void 0}get attrs(){return this.sheet.layout.attrs.get(Gg({wi:0,textAlign:0,direction:0}),this.va,
this.col)||{}}get N_(){return null!=this.isVisible?this.isVisible(this.col,this.va):!0}get sKa(){const a=this.sheet.layout.cells.get(this.va,this.col);return!a||a.span.bc===this.va&&a.span.Ub===this.col}get Or(){const a=this.sheet,b=this.va,c=this.col;if(!this.container)return{type:void 0,sheet:a,va:b,column:c};switch(this.container.type){case "fixed-page":return this.container.Aeb.Bd(c,b);case "sheet-item":return this.container.Mva.Bd(c,b);case "sheet-element":return this.container.lib.Bd(c,b);default:throw new F(this.container);
}}get renderer(){if(this.N_){var a=this.Av;if(a&&(a.content.ref||a.La.ref))return this.kD({context:{container:this.Or,attrs:this.attrs},lu:this.Tra,qh:this.qh})}}get vEa(){this.wEa.reportObserved();var a=UPb(()=>this.renderer);if(a&&(a="react"===a.type?this.W1:this.ZD,0!==a.childNodes.length&&(a=a.childNodes[0],a instanceof HTMLElement)))return{width:a.clientWidth,height:a.clientHeight}}constructor(a,b,c,d,e,f,g,h,k){uQb.j(this);var l,m,n,p,q,r;this.kD=a;this.rG=c;this.sheet=d;this.col=e;this.container=
g;this.isVisible=h;this.kua=k;this.m7=document.createElement("div");this.cR=document.createElement("div");this.BH=document.createElement("div");this.ZD=document.createElement("div");this.W1=document.createElement("div");this.wEa=TPb("content size atom");this.Tra=q5(()=>this.wEa.reportChanged());this.va=f;this.m7.className="_2JFriw";this.cR.className="imy9ug";this.BH.className=S4("pDMp7w",{_0yZ6Qg:"text3"!==(null===(m=this.Av)||void 0===m?void 0:null===(l=m.content.ref)||void 0===l?void 0:l.type),
qhF5uA:"text3"!==(null===(p=this.Av)||void 0===p?void 0:null===(n=p.content.ref)||void 0===n?void 0:n.type)&&"text2"!==(null===(r=this.Av)||void 0===r?void 0:null===(q=r.content.ref)||void 0===q?void 0:q.type)});this.ZD.className="_30B9pw";this.BH.appendChild(this.ZD);this.cR.appendChild(this.BH);this.W1.className="G7zH2w";this.fma=k(this.va,this.col,this);this.qh=t=>Q4(b,{...t,lu:this.Tra})}};var j5=class extends n5{static j(a){Q(a,{BZ:b5})}render(){const {sheet:a,container:b,fp:c,TZ:d,kD:e,fe:f,qh:g,viewport:h,cH:k,CVa:l=!1}=this.props;if(!a.layout.cols.empty&&!a.layout.rows.empty)return Q4("div",{className:S4("SNkrHw","ltr"===a.direction?"TA4X7w":"WvuqMw",{RaA0Nw:l}),...f,children:Q4(C5,{kD:e,qh:g,yYa:this.Bha,lY:this.lY,sheet:a,container:b,fp:c,TZ:d,aa:this.aa,viewport:h,cH:k,BZ:this.BZ})})}get BZ(){var a=this.props.sheet;const b={},c=a.view.freeze.RU?a.layout.Sd.get(a.view.freeze.RU):
void 0,d=a.view.freeze.DH?a.layout.Id.get(a.view.freeze.DH):void 0,e=a.layout.rows.first(),f=a.layout.rows.last(),g=a.layout.cols.first(),h=a.layout.cols.last();if(null!=e&&null!=f&&null!=g&&null!=h){var k=d?a.layout.cols.next(d):g;a=c?a.layout.rows.next(c):e;c&&d&&(b.JCa={range:{Ub:g,bc:e,Mc:d,Yc:c}});c&&k&&(b.OVa={range:{Ub:k,bc:e,Mc:h,Yc:c}});d&&a&&(b.fJa={range:{Ub:g,bc:a,Mc:d,Yc:f}});a&&k&&(b.wya={range:{Ub:k,bc:a,Mc:h,Yc:f}});return b}}get aa(){return this.props.aa?this.props.aa:b5(()=>1)}constructor(...a){super(...a);
j5.j(this);this.Bha=V4(b=>{const {sheet:c,Apa:d,aa:e,Q6:f="hidden"}=this.props;return Q4(y5,{sheet:c,range:b.range,aa:e,children:Q4(qQb,{...b,sheet:c,aa:this.aa,Apa:d,overflow:f})})});this.lY=(b,c)=>new __c.CGa(this.props.iG,this.props.Wz,this.props.sheet,b,c,this.aa,this.Nt,this.Qt);this.Nt=(b,c)=>{var d,e;return null===(d=(e=this.props).Nt)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)};this.Qt=(b,c)=>{var d,e;return null===(d=(e=this.props).Qt)||void 0===d?void 0:d.call(e,this.props.sheet,
b,c)}}};j5=t5([Kc],j5);__c.JGa={v9a:function(a){const b=a.Mn,c=a.ze,d=a.ed,e=a.Vl,f=a.iG,g=a.Wz,h=a.BW;iPb({Vz:a.Vz,tf:a.tf,Gjb:a.yO});const k=PPb({kD:h,iG:f,Wz:g});b.Tha=yPb({Xp:k});c.Cha=oPb({Xp:k});({CYa:a}=vPb({Xp:k,Ue:e(),eSa:new gQb}));d.gq.Sha=a;const {IWa:l,JWa:m,HWa:n}=nPb();return{KAa:V4(p=>Q4(ZPb,{...p,container:void 0,Xp:k,BYa:l,DYa:m,zYa:n,qh:$Pb}))}}};
}).call(self, self._7ccc7343da2ae983607b3819c7bc1f93);}

}])
//# sourceMappingURL=sourcemaps/6f0b993c60866663.js.map